# 智慧水域-运维系统-水质相关接口

quality：水质类型

```bash
(1, "一级"),
(2, "二级"),
(3, "三级"),
(4, "四级"),
(5, "五级"),
(6, "六级")
```

# 监测点相关接口：

## 创建监测点：

### 接口地址：v1/admin/detect_point/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名             | 备注   |
| ---------- | ------ | -------- | ---------------- | ------ |
| quality    | INT    | 否       | 水质类别         | 见详情 |
| provinceId | INT    | 否       | 省份             |        |
| cityId     | INT    | 否       | 城市             |        |
| areaId     | INT    | 否       | 区               |        |
| townId     | INT    | 否       | 城镇             |        |
| villageId  | INT    | 否       | 乡               |        |
| mUser      | STRING | 否       | 运维人员         |        |
| mMobile    | STRING | 否       | 运维人员联系方式 |        |
| address    | STRING | 否       | 地址             |        |
| lng        | STRING | 否       | 经度             |        |
| lat        | STRING | 否       | 纬度             |        |
| name       | STRING | 是       | 测点名称         |        |
| number     | STRING | 否       | 测点编号         |        |
| mUser      | STRING | 否       | 运维人员         |        |
| mMobile    | STRING | 否       | 联系电话         |        |
| shipId     | STRING | 是       | 船只编号         |        |
| watersId   | STRING | 是       | 监测水域         |        |
| userId     | INT    | 是       | 操作人ID         |        |

### 请求示例：

```bash
{
    "quality": 1,
    "address": "地址",
    "lng": "123.123",
    "lat": "20.12",
    "name": "名称",
    "number": "编号",
    "mUser": "品品",
    "mMobile": "13011112222",
    "provinceId":1,
    "cityId":1,
    "areaId":1,
    "shipId":2,
    "watersId":65,
    "cTime": "2021-10-23",
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 编辑监测点：

### 接口地址：v1/admin/detect_point/

### 请求方式：PUT

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名             | 备注   |
| ---------- | ------ | -------- | ---------------- | ------ |
| pointId    | INT    | 是       | 监测点ID         |        |
| quality    | INT    | 否       | 水质类别         | 见详情 |
| provinceId | INT    | 否       | 省份             |        |
| cityId     | INT    | 否       | 城市             |        |
| areaId     | INT    | 否       | 区               |        |
| townId     | INT    | 否       | 城镇             |        |
| villageId  | INT    | 否       | 乡               |        |
| mUser      | STRING | 否       | 运维人员         |        |
| mMobile    | STRING | 否       | 运维人员联系方式 |        |
| address    | STRING | 否       | 地址             |        |
| lng        | STRING | 否       | 经度             |        |
| lat        | STRING | 否       | 纬度             |        |
| name       | STRING | 是       | 测点名称         |        |
| number     | STRING | 否       | 测点编号         |        |
| mUser      | STRING | 否       | 运维人员         |        |
| mMobile    | STRING | 否       | 联系电话         |        |
| shipId     | STRING | 是       | 船只编号         |        |
| watersId   | STRING | 是       | 监测水域         |        |
| userId     | INT    | 是       | 操作人ID         |        |

### 请求示例：

```bash
{
    "pointId": 87,
    "quality": 1,
    "address": "地址",
    "lng": "123.123",
    "lat": "20.12",
    "name": "名称",
    "number": "编号",
    "mUser": "品品",
    "mMobile": "13011112222",
    "provinceId": 1,
    "cityId": 1,
    "areaId": 1,
    "shipId": 2,
    "watersId": 2,
    "cTime": "2021-10-23",
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取监测点详情：

### 接口地址：v1/admin/detect_point/

### 请求方式：GET

### 请求参数：

| 参数名  | 类型 | 是否必传 | 命名     | 备注 |
| ------- | ---- | -------- | -------- | ---- |
| pointId | INT  | 是       | 监测点ID |      |

### 请求示例：

```bash
{
		"pointId": 13
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "area_id": 1,  // 区域ID
            "waters__number": "0001",  // 检测水域
            "name": "名称2",  // 监测名称
            "ship__number": "0004",  // 船只编号
            "ship_id": 2,  // 船的ID
            "city_id": 1,  // 城市ID
            "waters__name": "西湖",  // 水域名称
            "number": "编号",  // 测点编号
            "m_mobile": "136111122222",  // 运维联系方式
            "m_user": "1品品",  // 运维人员
            "city__name": "杭州市",  // 城市名称
            "province__name": "浙江省",  // 省份名称
            "ship__name": "西湖前进号",  // 船的名称 
            "area__name": "萧山区",  // 区域名称
            "address": "地址2222",  // 地址
            "lat": "20.222",  // 经度
            "lng": "123.222",  // 纬度
            "province_id": 1,  // 省份ID
            "quality": 2,  // 水质等级
            "id": 13, // 监测点ID
            "waters_id": 2  // 水域ID
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 批量删除监测点：

### 接口地址：v1/admin/delete/detect_point/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型 | 是否必传 | 命名         | 备注 |
| -------- | ---- | -------- | ------------ | ---- |
| pointIds | LIST | 是       | 监测点ID列表 |      |

### 请求示例：

```bash
{
    "pointIds":[14,15]
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取监测点列表页：

### 接口地址：v1/admin/detect_point/list/

### 请求方式：GET

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名     | 备注     |      |
| ---------- | ------ | -------- | -------- | -------- | ---- |
| userId     | INT    | 是       | 用户ID   | 登录返回 |      |
| name       | STRING | 否       | 监测名称 |          |      |
| watersId   | INT    | 否       | 水域ID   | 筛选     |      |
| provinceId | INT    | 否       | 省份ID   | 筛选     |      |
| cityId     | INT    | 否       | 市ID     | 筛选     |      |
| areaId     | INT    | 否       | 区域ID   | 筛选     |      |

### 请求示例:

* 

### 响应

#### 200

```bash
// 见详情
{
    "data": {
        "count": 8,
        "list": [
            {
                "id": 13,
                "quality": 2,
                "address": "地址2222",
                "lng": "123.222",
                "lat": "20.222",
                "name": "名称2",
                "number": "编号",
                "mUser": "1品品",
                "mMobile": "136111122222",
                "provinceInfo": {
                    "id": 1,
                    "name": "浙江省"
                },
                "cityInfo": {
                    "id": 1,
                    "name": "杭州市"
                },
                "areaInfo": {
                    "id": 1,
                    "name": "萧山区"
                },
                "shipInfo": {
                    "id": 2,
                    "name": "西湖前进号",
                    "number": "0004"
                },
                "watersInfo": {
                    "id": 2,
                    "name": "西湖"
                },
                "cTime": "1634918400.000000"
            }
        ],
        "links": {
            "previous": null,
            "next": null
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

# 监测河段相关接口：

## 创建监测河段：

### 接口地址：v1/admin/detect_river/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名             | 备注   |
| ---------- | ------ | -------- | ---------------- | ------ |
| quality    | INT    | 否       | 水质类别         | 见详情 |
| provinceId | INT    | 否       | 省份             |        |
| cityId     | INT    | 否       | 城市             |        |
| areaId     | INT    | 否       | 区               |        |
| townId     | INT    | 否       | 城镇             |        |
| villageId  | INT    | 否       | 乡               |        |
| mUser      | STRING | 否       | 运维人员         |        |
| mMobile    | STRING | 否       | 运维人员联系方式 |        |
| address    | STRING | 否       | 地址             |        |
| sLng       | STRING | 否       | 起点经度         |        |
| sLat       | STRING | 否       | 起点纬度         |        |
| eLng       | STRING | 否       | 终点经度         |        |
| eLat       | STRING | 否       | 终点纬度         |        |
| name       | STRING | 是       | 测点名称         |        |
| number     | STRING | 否       | 测点编号         |        |
| mUser      | STRING | 否       | 运维人员         |        |
| mMobile    | STRING | 否       | 联系电话         |        |
| shipId     | STRING | 是       | 船只编号         |        |
| watersId   | STRING | 是       | 监测水域         |        |
| userId     | INT    | 是       | 操作人ID         |        |

### 请求示例：

```bash
{
    "quality": 1,
    "address": "地址",
    "sLng": "123.123",
    "sLat": "20.12",
    "eLng": "123.123",
    "eLat": "20.12",
    "name": "名称",
    "number": "编号",
    "mUser": "品品",
    "mMobile": "13011112222",
    "provinceId":1,
    "cityId":1,
    "areaId":1,
    "shipId":2,
    "watersId":2,
    "cTime": "2021-10-23",
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 编辑监测河段：

### 接口地址：v1/admin/detect_river/

### 请求方式：PUT

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名             | 备注   |
| ---------- | ------ | -------- | ---------------- | ------ |
| riverId    | INT    | 是       | 监测河段ID       |        |
| quality    | INT    | 否       | 水质类别         | 见详情 |
| provinceId | INT    | 否       | 省份             |        |
| cityId     | INT    | 否       | 城市             |        |
| areaId     | INT    | 否       | 区               |        |
| townId     | INT    | 否       | 城镇             |        |
| villageId  | INT    | 否       | 乡               |        |
| mUser      | STRING | 否       | 运维人员         |        |
| mMobile    | STRING | 否       | 运维人员联系方式 |        |
| address    | STRING | 否       | 地址             |        |
| sLng       | STRING | 否       | 起点经度         |        |
| sLat       | STRING | 否       | 起点纬度         |        |
| eLng       | STRING | 否       | 终点经度         |        |
| eLat       | STRING | 否       | 终点纬度         |        |
| name       | STRING | 是       | 测点名称         |        |
| number     | STRING | 否       | 测点编号         |        |
| mUser      | STRING | 否       | 运维人员         |        |
| mMobile    | STRING | 否       | 联系电话         |        |
| shipId     | STRING | 是       | 船只编号         |        |
| watersId   | STRING | 是       | 监测水域         |        |
| userId     | INT    | 是       | 操作人ID         |        |

### 请求示例：

```bash
{
    "riverId": 88,
    "quality": 1,
    "address": "地址11",
    "sLng": "123.1231",
    "sLat": "20.121",
    "eLng": "123.1231",
    "eLat": "20.121",
    "name": "名称2",
    "number": "编号2",
    "mUser": "品品",
    "mMobile": "13011112222",
    "provinceId":1,
    "cityId":1,
    "areaId":1,
    "shipId":2,
    "watersId":2,
    "cTime": "2021-10-23",
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取监测河段详情：

### 接口地址：v1/admin/detect_river/

### 请求方式：GET

### 请求参数：

| 参数名  | 类型 | 是否必传 | 命名       | 备注 |
| ------- | ---- | -------- | ---------- | ---- |
| riverId | INT  | 是       | 监测河段ID |      |

### 请求示例：

```bash
{
		"riverId": 13
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "area_id": 1,  // 区域ID
            "waters__number": "0001",  // 检测水域
            "name": "名称2",  // 监测名称
            "ship__number": "0004",  // 船只编号
            "ship_id": 2,  // 船的ID
            "city_id": 1,  // 城市ID
            "waters__name": "西湖",  // 水域名称
            "number": "编号",  // 测点编号
            "m_mobile": "136111122222",  // 运维联系方式
            "m_user": "1品品",  // 运维人员
            "city__name": "杭州市",  // 城市名称
            "province__name": "浙江省",  // 省份名称
            "ship__name": "西湖前进号",  // 船的名称 
            "area__name": "萧山区",  // 区域名称
            "address": "地址2222",  // 地址
            "s_lat": "20.222",  // 起点经度
            "s_lng": "123.222",  // 起点纬度
            "e_lat": "20.222",  // 终点经度
            "e_lng": "123.222",  // 终点纬度
            "province_id": 1,  // 省份ID
            "quality": 2,  // 水质等级
            "id": 13, // 监测点ID
            "waters_id": 2  // 水域ID
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 批量删除监测河段：

### 接口地址：v1/admin/delete/detect_river/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型 | 是否必传 | 命名           | 备注 |
| -------- | ---- | -------- | -------------- | ---- |
| riverIds | LIST | 是       | 监测河段ID列表 |      |

### 请求示例：

```bash
{
    "riverIds":[88], "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取监测河段列表页：

### 接口地址：v1/admin/detect_river/list/

### 请求方式：GET

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名     | 备注     |      |
| ---------- | ------ | -------- | -------- | -------- | ---- |
| userId     | INT    | 是       | 用户ID   | 登录返回 |      |
| name       | STRING | 否       | 监测名称 |          |      |
| watersId   | INT    | 否       | 水域ID   | 筛选     |      |
| provinceId | INT    | 否       | 省份ID   | 筛选     |      |
| cityId     | INT    | 否       | 市ID     | 筛选     |      |
| areaId     | INT    | 否       | 区域ID   | 筛选     |      |

### 请求示例:

* 

### 响应

#### 200

```bash
// 见详情
{
    "data": {
        "count": 8,
        "list": [
            {
                "id": 13,
                "quality": 2,
                "address": "地址2222",
                "s_lng": "123.222",
                "s_lat": "20.222",
                "e_lng": "123.222",
                "e_lat": "20.222",
                "name": "名称2",
                "number": "编号",
                "mUser": "1品品",
                "mMobile": "136111122222",
                "provinceInfo": {
                    "id": 1,
                    "name": "浙江省"
                },
                "cityInfo": {
                    "id": 1,
                    "name": "杭州市"
                },
                "areaInfo": {
                    "id": 1,
                    "name": "萧山区"
                },
                "shipInfo": {
                    "id": 2,
                    "name": "西湖前进号",
                    "number": "0004"
                },
                "watersInfo": {
                    "id": 2,
                    "name": "西湖"
                },
                "cTime": "1634918400.000000"
            }
        ],
        "links": {
            "previous": null,
            "next": null
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取监测河段详情页：

### 接口地址：v1/admin/detect_river/detail/

### 请求方式：GET

### 请求参数：

| 参数名   | 类型  | 是否必传 | 命名   | 备注 |      |
| -------- | ----- | -------- | ------ | ---- | ---- |
| ts       | FLOAT | 是       | 时间戳 |      | 毫秒 |
| watersId | INT   | 是       | 水域ID |      |      |

### 请求示例:

```bash
?ts=1605110400000&watersId=61
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "height": null,
            "s_time": 1605149048,
            "ship": {
                "number": "0004",
                "id": 17,
                "name": "QDF-0004"
            },
            "c_data": {
                "id": 8,
                "name": "温州市"
            },
            "wgs84_lat": "27.7777398407",
            "c_time": 1605139200000.0,
            "a_data": {
                "id": 12,
                "name": "瑞安市"
            },
            "ph": "",
            "cod": "",
            "waters": {
                "id": 61,
                "name": "温瑞塘河-瑞安(早)"
            },
            "nh4": "7.56",
            "nh3": "",
            "oxy_saturation": "",
            "_id": "61c840c4dffa716d3aea2152",
            "p_data": {
                "id": 1,
                "name": "浙江省"
            },
            "k": "",
            "diss_oxy": "",
            "_cls": "wisdom_waters_service.models.DynamicWaterQuality",
            "water_quality": null,
            "chlorophy": "",
            "turbidity": "",
            "wgs84_lng": "120.655640347"
        }
  }
```

# 定点水质相关接口:

## 创建、编辑时获取监测点位信息接口：(下拉框)

### 接口地址：v1/admin/fixed_point/label_list/

### 请求方式：GET

### 请求参数：

| 参数名   | 类型 | 是否必传 | 命名   | 备注 |      |
| -------- | ---- | -------- | ------ | ---- | ---- |
| watersId | INT  | 是       | 水域ID |      |      |

### 响应

#### 200

```bash
{
    "data": [
        {
            "number": "11111", // 监测点编号
            "id": 142, // 监测点ID 
            "name": "22222", // 监测点名称
            "waters_id": 92, // 水域ID
            "waters__name": "瑞平塘河", // 监测河段的水域名称
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 创建定点水质数据接口：

### 接口地址：v1/admin/fixed_point/

### 请求方式：POST

### 请求参数：

| 参数名         | 类型   | 是否必传 | 命名         | 备注                     |
| -------------- | ------ | -------- | ------------ | ------------------------ |
| cTs            | FLOAT  | 是       | 当天时间戳   | 秒级                     |
| watersDetectId | INT    | 是       | 监测点位ID   | 通过接口获取监测点位信息 |
| lng            | STRING | 是       | 纬度         |                          |
| lat            | STRING | 是       | 经度         |                          |
| ph             | STRING | 否       | PH           |                          |
| nh3            | STRING | 否       | 氨氮         |                          |
| dissOxy        | STRING | 否       | 溶解氧       |                          |
| oxySaturation  | STRING | 否       | 溶解氧饱和度 |                          |
| cod            | STRING | 否       | 化学需氧量   |                          |
| chlorophy      | STRING | 否       | 叶绿素       |                          |
| tn             | STRING | 否       | 总氮         |                          |
| tp             | STRING | 否       | 总磷         |                          |
| sod            | STRING | 否       | 透明度       |                          |
| codMn          | STRING | 否       | 高锰酸钾     |                          |
| tsm            | STRING | 否       | 悬浮物       |                          |
| conduct        | STRING | 否       | 电阻率       |                          |
| temp           | STRING | 否       | 温度         |                          |
| turbidity      | STRING | 否       | 浊度         |                          |
| userId         | INT    | 是       | 操作人ID     |                          |

### 请求示例:

```bash
{
    "cTs": 1671897600,
    "watersDetectId": 138,
    "lng": "120.0861493",
    "lat": "30.16734433",
    "ph": "7.1",
    "nh3": "1",
    "dissOxy": "12.1",
    "oxySaturation": "1",
    "cod": "1",
    "chlorophy": "22.1",
    "tn": "1.2",
    "tp": "1.2",
    "sod": "33.1",
    "codMn": "31",
    "tsm": "1",
    "conduct": "33",
    "temp": "11",
    "turbidity": "22",
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 编辑定点水质数据接口：

### 接口地址：v1/admin/fixed_point/

### 请求方式：PUT

### 请求参数：

| 参数名         | 类型   | 是否必传 | 命名         | 备注                     |
| -------------- | ------ | -------- | ------------ | ------------------------ |
| watersDataId   | INT    | 是       | 定点水质ID   |                          |
| cTs            | FLOAT  | 是       | 当天时间戳   | 秒级                     |
| watersDetectId | INT    | 是       | 监测点位ID   | 通过接口获取监测点位信息 |
| lng            | STRING | 是       | 纬度         |                          |
| lat            | STRING | 是       | 经度         |                          |
| ph             | STRING | 否       | PH           |                          |
| nh3            | STRING | 否       | 氨氮         |                          |
| dissOxy        | STRING | 否       | 溶解氧       |                          |
| oxySaturation  | STRING | 否       | 溶解氧饱和度 |                          |
| cod            | STRING | 否       | 化学需氧量   |                          |
| chlorophy      | STRING | 否       | 叶绿素       |                          |
| tn             | STRING | 否       | 总氮         |                          |
| tp             | STRING | 否       | 总磷         |                          |
| sod            | STRING | 否       | 透明度       |                          |
| codMn          | STRING | 否       | 高锰酸钾     |                          |
| tsm            | STRING | 否       | 悬浮物       |                          |
| conduct        | STRING | 否       | 电阻率       |                          |
| temp           | STRING | 否       | 温度         |                          |
| turbidity      | STRING | 否       | 浊度         |                          |
| userId         | INT    | 是       | 操作人ID     |                          |

### 请求示例:

```bash
{
    "watersDataId": 412,
    "cTs": 1671897600,
    "watersDetectId": 137,
    "lng": "121.60474",
    "lat": "29.8755799",
    "ph": "6.1",
    "nh3": "6",
    "oxy": "6.1",
    "oxySaturation": "6",
    "cod": "6",
    "chlorophy": "66.1",
    "tn": "6.2",
    "tp": "6.2",
    "sod": "66.1",
    "codMn": "66",
    "tsm": "6",
    "conduct": "66",
    "temp": "66",
    "turbidity": "66",
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取定点水质数据详情接口：

### 接口地址：v1/admin/fixed_point/?watersDataId=412

### 请求方式：GET

### 请求参数：

| 参数名       | 类型 | 是否必传 | 命名       | 备注 |
| ------------ | ---- | -------- | ---------- | ---- |
| watersDataId | INT  | 是       | 定点水质ID |      |

### 请求示例:

```bash
?watersDataId=412
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "sod": "66.1", // 透明度
            "water_quality__waters__name": "宋河", // 水域名称
            "weather_temp": "最高温度7~最低温度0", // 温差
            "oxy_saturation": "6", // 溶解氧饱和度
            "s_time": "2022-12-24T16:00:00Z", //时间
            "lng": "121.60474", // 纬度
            "id": 412, // 定点水质ID
            "water_quality__city__name": "杭州市", // 城市信息
            "wq_ts": "1671897600",  // 当天时间戳
            "tsm": "6", // 悬浮物
            "cod_mn": "66", // 高锰酸钾
            "water_quality__name": "暗管05", // 定点水域名称
            "water_quality__area_id": 13, // 区域ID
            "tp": "6.2", // 总磷
            "tn": "6.2", // 总氮
            "conduct": "66",  // 电阻率
            "water_quality__province_id": 1, // 省份ID
            "ph": "6.1", // ph
            "water_quality__city_id": 1, // 城市ID 
            "e_time": "2022-12-25T00:00:00Z", // 时间字符串
            "water_quality__waters_id": 88, // 水域ID
            "water_quality__province__name": "浙江省", // 省份ID
            "nh3": "6", // nh3
            "lat": "29.8755799", // 经度
            "water_quality__area__name": "西湖区", // 区域信息
            "weather_state": "晴", // 天气
            "temp": "66", // 温度
            "chlorophy": "66.1", // 叶绿素
            "diss_oxy": "", // 溶解氧
            "cod": "6", // 化学需氧量
            "turbidity": "66" // 浊度
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```



## 定点水质批量删除接口：

### 接口地址：v1/admin/delete/fixed_point/

### 请求方式：POST

### 请求参数：

| 参数名       | 类型 | 是否必传 | 命名           | 备注 |      |
| ------------ | ---- | -------- | -------------- | ---- | ---- |
| waterDataIds | LIST | 是       | 定点水质数据ID | 筛选 | 列表 |
| userId       | INT  | 是       | 操作人ID       |      |      |

### 请求示例:

```bash
{"waterDataIds": [106], "userId": 1}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 定点水质列表页：

### 接口地址：v1/admin/fixed_point/list/

### 请求方式：GET

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名         | 备注     |      |
| ---------- | ------ | -------- | ------------ | -------- | ---- |
| userId     | INT    | 是       | 用户ID       | 登录返回 |      |
| sTime      | STRING | 否       | 监测开始时间 | 筛选     |      |
| eTime      | STRING | 否       | 监测结束时间 | 筛选     |      |
| watersId   | INT    | 否       | 水域ID       | 筛选     |      |
| provinceId | INT    | 否       | 省份ID       | 筛选     |      |
| cityId     | INT    | 否       | 市ID         | 筛选     |      |
| areaId     | INT    | 否       | 区域ID       | 筛选     |      |

### 请求示例:

* 

### 响应

#### 200

```bash
{
    "data": {
        "count": 2,  // 总数
        "list": [
            {
                "id": 10,  // 定点水质ID
                "lng": "120.900683",  
                "lat": "30.21611", 
                "ph": "7.19", // ph
                "nh3": "0.016075216972",  // nh3
                "nh4": "1.40598196393",  // nh4
                "k": "0.0945891783567", // K
                "cod": "4.96931863727",  // 化学需氧量
                "turbidity": "23.7403306613",  // 浊度
                "dissOxy": "78.3954008016", // 溶解氧
                "oxySaturation": "9.97",  // 溶解氧饱和度
                "cTime": "1631666676.000000",  // 创建时间
                "wqTs": null,  // 水质上报时间戳
                "provinceInfo": {  // 监测省份
                    "id": 1,
                    "name": "浙江省"
                },
                "cityInfo": {  // 监测城市
                    "id": 1,
                    "name": "杭州市"
                },
                "areaInfo": {  // 监测区
                    "id": 1,
                    "name": "萧山区"
                },
                "shipInfo": {  // 船相关信息
                    "id": 2,
                    "name": "西湖前进号",
                    "number": "0004"
                },
                "watersInfo": {  // 监测水域
                    "id": 2,
                    "name": "西湖"
                },
                "waterQualityInfo": {  // 监测点位信息
                    "id": 13,  
                    "name": "名称2",  // 监测点
                    "number": "编号"  // 监测点编号
                    "lat": "20.222", // 监测点纬度
                    "lng": "123.222",  // 监测点经度
                }
            }
        ],
        "links": {
            "previous": null,
            "next": null
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

# 动态水质相关接口:

## 创建、编辑时获取监测河段信息接口：(下拉框)

### 接口地址：v1/admin/dynamic/label_list/

### 请求方式：GET

### 请求参数：

| 参数名   | 类型 | 是否必传 | 命名   | 备注 |      |
| -------- | ---- | -------- | ------ | ---- | ---- |
| watersId | INT  | 是       | 水域ID |      |      |

### 响应

#### 200

```bash
{
    "data": [
        {
            "waters_id": 92, // 水域ID
            "waters__name": "瑞平塘河", // 监测河段的水域名称
            "number": "", // 河段编号
            "id": 143, // 监测河段ID
            "name": "河段" // 监测河段
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 创建动态水质接口：

### 接口地址：v1/admin/dynamic/

### 请求方式：POST

### 请求参数：

| 参数名         | 类型   | 是否必传 | 命名         | 备注                     |
| -------------- | ------ | -------- | ------------ | ------------------------ |
| cTs            | FLOAT  | 是       | 当前时间戳   | 秒级                     |
| watersDetectId | INT    | 是       | 监测点位ID   | 通过接口获取监测点位信息 |
| lng            | STRING | 是       | 纬度         |                          |
| lat            | STRING | 是       | 经度         |                          |
| ph             | STRING | 否       | PH           |                          |
| nh3            | STRING | 否       | 氨氮         |                          |
| dissOxy        | STRING | 否       | 溶解氧       |                          |
| oxySaturation  | STRING | 否       | 溶解氧饱和度 |                          |
| cod            | STRING | 否       | 化学需氧量   |                          |
| chlorophy      | STRING | 否       | 叶绿素       |                          |
| tn             | STRING | 否       | 总氮         |                          |
| tp             | STRING | 否       | 总磷         |                          |
| sod            | STRING | 否       | 透明度       |                          |
| codMn          | STRING | 否       | 高锰酸钾     |                          |
| tsm            | STRING | 否       | 悬浮物       |                          |
| conduct        | STRING | 否       | 电阻率       |                          |
| temp           | STRING | 否       | 温度         |                          |
| turbidity      | STRING | 否       | 浊度         |                          |
| userId         | INT    | 是       | 操作人ID     |                          |

### 请求示例:

```bash
{
    "cTs": 1671975377,
    "watersDetectId": 143,
    "lng": "120.0861493",
    "lat": "30.16734433",
    "ph": "7.1",
    "nh3": "1",
    "dissOxy": "12.1",
    "oxySaturation": "1",
    "cod": "1",
    "chlorophy": "22.1",
    "tn": "1.2",
    "tp": "1.2",
    "sod": "33.1",
    "codMn": "31",
    "tsm": "1",
    "conduct": "33",
    "temp": "11",
    "turbidity": "22",
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 编辑动态水质接口：

### 接口地址：v1/admin/dynamic/

### 请求方式：PUT

### 请求参数：

| 参数名         | 类型   | 是否必传 | 命名         | 备注                     |
| -------------- | ------ | -------- | ------------ | ------------------------ |
| cTs            | FLOAT  | 是       | 当前时间戳   | 秒级                     |
| watersDetectId | INT    | 是       | 监测点位ID   | 通过接口获取监测点位信息 |
| objId          | STRING | 是       | 动态水质ID   | mongo表的ID              |
| lng            | STRING | 是       | 纬度         |                          |
| lat            | STRING | 是       | 经度         |                          |
| ph             | STRING | 否       | PH           |                          |
| nh3            | STRING | 否       | 氨氮         |                          |
| dissOxy        | STRING | 否       | 溶解氧       |                          |
| oxySaturation  | STRING | 否       | 溶解氧饱和度 |                          |
| cod            | STRING | 否       | 化学需氧量   |                          |
| chlorophy      | STRING | 否       | 叶绿素       |                          |
| tn             | STRING | 否       | 总氮         |                          |
| tp             | STRING | 否       | 总磷         |                          |
| sod            | STRING | 否       | 透明度       |                          |
| codMn          | STRING | 否       | 高锰酸钾     |                          |
| tsm            | STRING | 否       | 悬浮物       |                          |
| conduct        | STRING | 否       | 电阻率       |                          |
| temp           | STRING | 否       | 温度         |                          |
| turbidity      | STRING | 否       | 浊度         |                          |
| userId         | INT    | 是       | 操作人ID     |                          |

### 请求示例:

```bash
{
    "cTs": 1671975377,
    "watersDetectId": 91,
    "objId": "63a851f307ebf3189601d72d",
    "lng": "120.900683",
    "lat": "30.21611",
    "ph": "6.1",
    "nh3": "6",
    "dissOxy": "66.1",
    "oxySaturation": "6",
    "cod": "6",
    "chlorophy": "66.1",
    "tn": "6.2",
    "tp": "6.2",
    "sod": "66.1",
    "codMn": "61",
    "tsm": "6",
    "conduct": "66",
    "temp": "66",
    "turbidity": "66",
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 动态水质列表页：

### 接口地址：v1/admin/dynamic/list/

### 请求方式：GET

### 请求参数：

| 参数名     | 类型  | 是否必传 | 命名     | 备注             |      |
| ---------- | ----- | -------- | -------- | ---------------- | ---- |
| page       | INT   | 是       | 页码     |                  |      |
| ts         | FLOAT | 否       | 日期筛选 | 传递的毫秒时间戳 |      |
| userId     | INT   | 是       | 用户ID   | 做权限使用       |      |
| watersId   | INT   | 否       | 水域ID   | 筛选             |      |
| provinceId | INT   | 否       | 省份ID   | 筛选             |      |
| cityId     | INT   | 否       | 市ID     | 筛选             |      |
| areaId     | INT   | 否       | 区域ID   | 筛选             |      |

### 请求示例:

* 

### 响应

#### 200

```bash
{
    "data": [
        {
            "c_data": {  // 城市信息
                "id": 1,
                "name": "杭州市"
            },
            "p_data": {  // 省份信息
                "id": 1,
                "name": "浙江省"
            },
            "turbidity": "",  // 浊度 
            "water_quality": { // 水域河段信息
                "id": 5,  // 水域河段ID 
                "name": "孝义河段"  // 水域河段名称
            },
            "wgs84_lat": "32.0413094", // 纬度
            "c_time": 1635064444688.0,  // 创建时间
            "chlorophy": "",  // 绿叶素
            "k": "",  // k
            "_cls": "wisdom_waters_service.models.DynamicWaterQuality",
            "oxy_saturation": "",  // 溶解氧饱和度
            "diss_oxy": "",   //  溶解氧
            "nh4": "",  // nh4
            "a_data": {  // 区域信息
                "id": 1,
                "name": "萧山区"
            },
            "cod": "",  // 化学需氧量
            "nh3": "",  // nh3
            "s_time": 1635064425,  // 发送时间
            "ph": "",  // ph
            "_id": "61751a7cad05290048c0bf80",
            "wgs84_lng": "118.75823", // 经度
            "ship": {  // 船的信息
                "number": "0004",
                "id": 2,
                "name": "西湖前进号"
            },
            "waters": {  // 水域信息
                "id": 2,
                "name": "西湖"
            }
        },
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 删除动态水质：

### 接口地址：v1/admin/delete/dynamic/

### 请求方式：POST

### 请求参数：

| 参数名       | 类型   | 是否必传 | 命名         | 备注 |      |
| ------------ | ------ | -------- | ------------ | ---- | ---- |
| waterDataIds | STRING | 是       | 动态水质信息 |      |      |
| userId       | INT    | 是       | 操作人ID     |      |      |

### 请求示例:

```bash
{
    "waterDataIds": [
        "618d3626dffa71d74cb1e83c"
    ],
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

# 水质评价相关接口：

## 创建水质评价：

### 接口地址：v1/admin/water_quality/category/

### 请求方式：POST

### 请求参数：

| 参数名 | 类型   | 是否必传 | 命名     | 备注 |
| ------ | ------ | -------- | -------- | ---- |
| code   | STRING | 是       | 水质CODE |      |
| name   | STRING | 是       | 水质指标 |      |
| i      | STRING | 否       | 一级类别 |      |
| ii     | STRING | 否       | 二级类别 |      |
| iii    | STRING | 否       | 三级类别 |      |
| iv     | STRING | 否       | 四级类别 |      |
| v      | STRING | 否       | 五级类别 |      |
| memo   | STRING | 否       | 备注     |      |

### 请求示例:

```bash
{
    "code": "ph",
    "name": "PH",
    "i": "6",
    "ii": "7",
    "iii": "8",
    "iv": "9",
    "v": "10",
    "memo": "人为造成环境水温变化"
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 编辑水质评价：

### 接口地址：v1/admin/water_quality/category/

### 请求方式：PUT

### 请求参数：

| 参数名  | 类型   | 是否必传 | 命名       | 备注 |
| ------- | ------ | -------- | ---------- | ---- |
| waterId | INT    | 是       | 水质评价ID |      |
| code    | STRING | 是       | 水质CODE   |      |
| name    | STRING | 是       | 水质指标   |      |
| i       | STRING | 否       | 一级类别   |      |
| ii      | STRING | 否       | 二级类别   |      |
| iii     | STRING | 否       | 三级类别   |      |
| iv      | STRING | 否       | 四级类别   |      |
| v       | STRING | 否       | 五级类别   |      |
| memo    | STRING | 否       | 备注       |      |

### 请求示例:

```bash
{
    "waterId": 1,
    "code": "ph",
    "name": "PH",
    "i": "6",
    "ii": "7",
    "iii": "8",
    "iv": "9",
    "v": "10",
    "memo": "人为造成环境水温变化1"
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取水质评价详情：

### 接口地址：v1/admin/water_quality/category/

### 请求方式：GET

### 请求参数：

| 参数名  | 类型 | 是否必传 | 命名       | 备注 |
| ------- | ---- | -------- | ---------- | ---- |
| waterId | INT  | 是       | 水质评价ID |      |

### 请求示例:

```bash
{
    "waterId": 1
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "code": "ph",  // 水质指标CODE
            "name": "PH",  // 水质指标
            "i": "6",  // I类
            "memo": "人为造成环境水温变化1", // 备注信息
            "iv": "9",  // II类
            "ii": "7",  // III类
            "v": "10",  // V类
            "iii": "8",  // IV类
            "id": 1  // 水质评价ID
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 批量删除水质评价详情：

### 接口地址：v1/admin/delete/wq/category/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型 | 是否必传 | 命名           | 备注 |
| -------- | ---- | -------- | -------------- | ---- |
| waterIds | LIST | 是       | 水质评价ID列表 |      |

### 请求示例:

```bash
{
    "waterIds": [1,2]
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水质评价列表页：

### 接口地址：v1/admin/water_quality/category/list/

### 请求方式：GET

### 请求参数：

| 参数名 | 类型   | 是否必传 | 命名             | 备注 |
| ------ | ------ | -------- | ---------------- | ---- |
| name   | STRING | 否       | 水质评价指标筛选 |      |

### 请求示例:

```bash
{
    "name": "ph"
}
```

### 响应

#### 200

```bash
// 同详情
{
    "data": {
        "count": 1,
        "list": [
            {
                "id": 1,  
                "code": "ph",
                "name": "PH",
                "i": "6",
                "ii": "7",
                "iii": "8",
                "iv": "9",
                "v": "10",
                "memo": "人为造成环境水温变化1"
            }
        ],
        "links": {
            "previous": null,
            "next": null
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 创建水质阈值：

> 注意：说有水域阈值 "≥ 36.1" 传值时需要注意, ≥ 后面加一个空格，否则运算解析时, 无法判断符号。

### 接口地址：/v1/admin/water_quality/threshold/

### 请求方式：POST

### 请求参数：

| 参数名    | 类型   | 是否必传 | 命名       | 备注          |
| --------- | ------ | -------- | ---------- | ------------- |
| projectId | INT    | 是       | 项目ID     |               |
| watersId  | INT    | 是       | 水域ID     |               |
| ph        | STRING | 否       | ph         |               |
| conduct   | STRING | 否       | 电阻率     |               |
| dissOxy   | STRING | 否       | 溶解氧     |               |
| turbidity | STRING | 否       | 浊度       |               |
| temp      | STRING | 否       | 温度       |               |
| tp        | STRING | 否       | 总磷       |               |
| tn        | STRING | 否       | 总氮       |               |
| nh        | STRING | 否       | 氨氮       |               |
| cod       | STRING | 否       | 化学需氧量 |               |
| chlorophy | STRING | 否       | 叶绿素     |               |
| sod       | STRING | 否       | 透明度     |               |
| codMn     | STRING | 否       | 高锰酸钾   |               |
| tsm       | STRING | 否       | 悬浮物     |               |
| isEnabled | INT    | 是       | 是否禁用   | 1:启用 0:禁用 |
| userId    | INT    | 是       | 操作人ID   |               |

### 请求示例:

```bash
// 注意所有水质阈值,传参 符号跟数值 中间有一个空格, 否则解析会失败。
{
    "projectId": 76,
    "watersId": 75,
    "ph": "≥ 36.1",
    "conduct": "≥ 36.1",
    "dissOxy": "≥ 31.1",
    "turbidity": "≤ 6.1",
    "temp": "≥ 3.1",
    "tp": "≤ 3.111",
    "tn": "≥ 46.1",
    "nh": "≤ 56.1",
    "cod": "≥ 116.1",
    "chlorophy": "≥ 36.9",
    "isEnabled": 0,
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 编辑水质阈值：

> 注意：说有水域阈值 "≥ 36.1" 传值时需要注意, ≥ 后面加一个空格，否则运算解析时, 无法判断符号。

### 接口地址：/v1/admin/water_quality/threshold/

### 请求方式：PUT

### 请求参数：

| 参数名      | 类型   | 是否必传 | 命名       | 备注          |
| ----------- | ------ | -------- | ---------- | ------------- |
| thresholdId | INT    | 是       | 水域阈值ID |               |
| projectId   | INT    | 是       | 项目ID     |               |
| watersId    | INT    | 是       | 水域ID     |               |
| ph          | STRING | 否       | ph         |               |
| conduct     | STRING | 否       | 电阻率     |               |
| dissOxy     | STRING | 否       | 溶解氧     |               |
| turbidity   | STRING | 否       | 浊度       |               |
| temp        | STRING | 否       | 温度       |               |
| tp          | STRING | 否       | 总磷       |               |
| tn          | STRING | 否       | 总氮       |               |
| nh          | STRING | 否       | 氨氮       |               |
| cod         | STRING | 否       | 化学需氧量 |               |
| chlorophy   | STRING | 否       | 叶绿素     |               |
| sod         | STRING | 否       | 透明度     |               |
| codMn       | STRING | 否       | 高锰酸钾   |               |
| tsm         | STRING | 否       | 悬浮物     |               |
| isEnabled   | INT    | 是       | 是否禁用   | 1:启用 0:禁用 |
| userId      | INT    | 是       | 操作人ID   |               |

### 请求示例:

```bash
// 注意所有水质阈值,传参 符号跟数值 中间有一个空格, 否则解析会失败。
{
    "thresholdId": 4,
    "projectId": 80,
    "watersId": 56,
    "ph": "≥ 36.6",
    "conduct": "≥ 36.6",
    "dissOxy": "≥ 31.6",
    "turbidity": "≤ 6.6",
    "temp": "≥ 3.6",
    "tp": "≤ 3.116",
    "tn": "≥ 46.6",
    "nh": "≤ 56.6",
    "cod": "≥ 116.6",
    "chlorophy": "≥ 36.9",
    "isEnabled": 1,
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取水质阈值：

> 注意：水质相信息, 返回的参数, 需要前端自己处理符号跟阈值

### 接口地址：/v1/admin/water_quality/threshold/

### 请求方式：GET

### 请求参数：

| 参数名      | 类型 | 是否必传 | 命名       | 备注 |
| ----------- | ---- | -------- | ---------- | ---- |
| thresholdId | INT  | 是       | 水域阈值ID |      |

### 请求示例:

```bash
?thresholdId=4
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "nh": "≤ 56.6",  // 氨氮
            "tn": "≥ 46.6",  //  总氮
            "project_id": 80,  // 项目ID
            "waters_id": 56,  // 水域ID
            "s_ts": "1664764219",  // 开始时间戳
            "temp": "≥ 3.6",  // 温度
            "c_time": "2022-10-03T02:30:19.881798Z", // 创建时间字符串
            "is_enabled": true, // 是否禁用 true: 启用、false：禁用
            "chlorophy": "≥ 36.9",  // 叶绿素
            "s_time": "2022-10-03T00:00:00Z", // 开始时间戳
            "tp": "≤ 3.116",  // 总磷
            "diss_oxy": "≥ 31.6", // 溶解氧
            "cod": "≥ 116.6", // 化学需氧量
            "conduct": "≥ 36.6", // 电阻率
            "waters__name": "温瑞塘河",  // 水域信息
            "ph": "≥ 36.6", // ph
            "turbidity": "≤ 6.6", // 浊度
            "cod_mn": "≥ 6", // 高锰酸钾
            "tsm": "≥ 6",  // 悬浮物
            "sod": "≥ 6", // 透明度
            "id": 4, // 主键ID
            "project__name": "浙江瑞安天井垟河"  // 项目名称
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取水质阈值列表页：

### 接口地址：/v1/admin/water_quality/threshold/list/?userId=1

### 请求方式：GET

### 请求参数：

| 参数名    | 类型 | 是否必传 | 命名     | 备注           |
| --------- | ---- | -------- | -------- | -------------- |
| userId    | INT  | 是       | 用户ID   | 登录用户ID权限 |
| projectId | INT  | 否       | 项目ID   | 筛选用         |
| watersId  | INT  | 否       | 水域ID   | 筛选用         |
| excel     | INT  | 否       | 是否导出 | 0:否、1:是     |

### 请求示例:

```bash
?userId=1&projectId=1&watersId=66
```

### 响应

#### 200

```bash
{
    "data": {
        "count": 2, // 总数
        "list": [           
            {
            "nh": "≤ 56.6",  // 氨氮
            "tn": "≥ 46.6",  //  总氮
            "sts": "1664764219",  // 开始时间戳
            "temp": "≥ 3.6",  // 温度
            "cTime": "1664755200.000000",, // 创建时间字符串
            "isEnabled": true, // 是否禁用 true: 启用、false：禁用
            "chlorophy": "≥ 36.9",  // 叶绿素
            "sTime":"1664755200.000000", // 开始时间戳
            "tp": "≤ 3.116",  // 总磷
            "dissOxy": "≥ 31.6", // 溶解氧
            "cod": "≥ 116.6", // 化学需氧量
            "conduct": "≥ 36.6", // 电阻率
            "ph": "≥ 36.6", // ph
            "turbidity": "≤ 6.6", // 浊度
            "cod_mn": "≥ 6", // 高锰酸钾
            "tsm": "≥ 6",  // 悬浮物
            "sod": "≥ 6", // 透明度
            "id": 4, // 主键ID
            "watersInfo": { // 水域信息
	            "id": 56,  // 水域ID
	            "name": "温瑞塘河"  // 水域名称
            },
            "projectInfo": {  // 项目信息
  	          "num": "ZJ-RA-TJYH20220717",  // 项目编号
    	        "id": 80,  // 项目ID
      	      "name": "浙江瑞安天井垟河"  // 项目名称
        	    }
            }
        ],
        "links": {
            "previous": null, // 上一页
            "next": null  // 下一页
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 批量删除水质阈值：

### 接口地址：/v1/admin/batch_delete/water_quality/threshold/

### 请求方式：POST

### 请求参数：

| 参数名       | 类型 | 是否必传 | 命名           | 备注 |
| ------------ | ---- | -------- | -------------- | ---- |
| thresholdIds | LIST | 是       | 水域阈值ID列表 |      |
| userId       | INT  | 是       | 操作人ID       |      |

### 请求示例:

```bash
{
    "thresholdIds": [
        8
    ],
    "userId": 1
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

