# 智慧水域-系统管理-系统日志

## 获取操作系统日志列表：

### 接口地址：v1/admin/system_logs/list/

### 请求方式：GET

### 请求参数：

| 参数名 | 类型   | 是否必传 | 命名               | 备注                                                         |
| ------ | ------ | -------- | ------------------ | ------------------------------------------------------------ |
| page   | INT    | 是       | 页码               | 页码                                                         |
| mobile | STRING | 否       | 账号               | 搜索使用                                                     |
| sTs    | INT    | 否       | 开始时间戳(秒级别) | 搜索使用                                                     |
| eTs    | INT    | 否       | 结束时间戳(秒级别) | 搜索使用                                                     |
| action | INT    | 否       | 操作类型           | 搜索使用：0、创建、1：修改、2：查询、3：删除、4：启用、5：禁用、6：登录 |
| excel  | INT    | 否       | 是否导出           | 1:表示导出                                                   |

### 请求示例:

```bash
?mobile=13&sTs=1663674917&eTs=1664020517
```

### 响应

#### 200

```bash
{
    "data": {
        "count": 13, // 总页数
        "system_logs_list": [ // 列表数据
            {
                "s_ts": 1663940900,  // 访问日期
                "name": "吕品品",  // 访问人
                "mobile": "13069634825",  // 访问账号
                "ip": "127.0.0.1",  // ip地址, 这里需要前端传参时,获取IP传递给后端
                "target_id": "30", // 目标ID
                "_cls": "wisdom_waters_service.models.SystemLog",
                "time": 1663940900961.0,  // 操作时间
                "action": 0,  // 操作行为
                "_id": "632db925a541dd9dc0ca801b",
                "type": 25, // 操作类型
                "desc": "吕品品/(13069634825)用户添加了语音内容为:前方人员请注意，请停止非法捕鱼，湖里的鱼这么可爱，你忍心吃吗?的信息。" // 操作详情信息
            }
        ]
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 修改操作系统日志：

### 接口地址：v1/admin/system_logs/

### 请求方式：PUT

### 请求参数：

| 参数名   | 类型   | 是否必传 | 命名           | 备注 |
| -------- | ------ | -------- | -------------- | ---- |
| objectId | STRING | 是       | 系统日志ID     |      |
| ip       | STRING | 是       | IP地址         |      |
| desc     | STRING | 是       | 描述详情       |      |
| mobile   | STRING | 是       | 账号信息       |      |
| sTs      | INT    | 是       | 时间戳(秒级别) |      |

### 请求示例:

```bash
{
    "objectId": "632db925a541dd9dc0ca801b",
    "ip": "13.11.1.11",
    "desc": "123",
    "mobile": "123456",
    "sTs": 1664029962
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取操作系统预警列表：

### 接口地址：v1/admin/system_monitor/list/?userId=1&shipName=苏

### 请求方式：GET

### 请求参数：

| 参数名   | 类型   | 是否必传 | 命名       | 备注                                                         |
| -------- | ------ | -------- | ---------- | ------------------------------------------------------------ |
| userId   | INT    | 是       | 登录用户ID | 权限控制                                                     |
| sTime    | STRING | 否       | 开始时间   | 筛选                                                         |
| eTime    | STRING | 否       | 结束时间   | 筛选                                                         |
| shipName | STRING | 否       | 船名       | 筛选                                                         |
| action   | INT    | 否       | 操作类型   | 搜索使用：0、创建、1：修改、2：查询、3：删除、4：启用、5：禁用、6：登录 |
| excel    | INT    | 否       | 是否导出   | 1:表示导出                                                   |

### 请求示例:

```bash
?mobile=13&sTs=1663674917&eTs=1664020517
```

### 响应

#### 200

```bash
{
    "data": {
        "count": 8, // 总数量
        "list": [
            {
                "id": 31, // 系统预警ID
                "memo": null, // 备注信息
                "systemType": 5, // 系统监控类型 1:定位异常、2:航行轨迹异常、3:大屏视频信号异常、4:APP视频信号异常、5:垃圾重量异常
                "cTime": "2023-06-18T10:29:41.512498+08:00", // 第一次预警事件
                "sTime": 1687084181, // 最近一次预警事件
                "todayTs": 1687017600, // 今日时间戳
                "shipInfo": {  // 船舶信息
                    "id": 78, // 船舶ID
                    "name": "苏市水保5001", // 船舶名称
                    "number": "0033" // 船舶编号
                }
            },
        ],
        "links": {
            "previous": null, // 上一页
            "next": null // 下一页
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

