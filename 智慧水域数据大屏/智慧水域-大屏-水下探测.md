# 智慧水域-大屏-水下探测

**字段描述**：

保洁业务 task_type:

```bash
(1, u"水下检测"),
(2, u"河道测绘")
```

探测分类 detect_type:

```bash
(1, u"暗管测绘"),
(2, u"水下异物"),
(3, u"河湖测量"),
(4, u"河道断面测量"),
(5, u"渠堤测量")
```

设备分类 device_type：

```bash
(1, u"多波束"),
(2, u"侧扫")
```

页签：book_mark_type

```bash
(1, u"数字河道"),
# 对应: 河道断面测量  type = 4
(2, u"横断面"),
(3, u"纵断面"),
# 对应: 河道 type = 1、2
(4, u"明暗管坐标")
```



## 水下探测总览：

### 接口地址：/v1/pc/detect/overall/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型 | 是否必传 | 命名   | 备注                     |
| ---------- | ---- | -------- | ------ | ------------------------ |
| year       | INT  | 是       | 年     | 必传                     |
| month      | INT  | 否       | 月     | 月份筛选                 |
| projectIds | LIST | 是       | 项目ID | 登录成功以后返回的项目ID |

### 请求示例:

```bash
{
    "year": 2021,
    "month": 9,
    "projectIds": [2]
}
```

### 响应

#### 200

```bash
{
    "data": {
        "sectionCount": 2, // 测量断面
        "pipelineCount": 3,  // 疑似暗管
        "surveyAreas": 200.0,  // 测绘面积
        "surveyCount": 2,  // 测绘次数
        "detectDistance": 100.0,  // 探测距离
        "detectCount": 2  // 探测次数
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水下探测总览详情：

### 接口地址：/v1/pc/detect/overall/list/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名     | 备注                     |
| ---------- | ------ | -------- | -------- | ------------------------ |
| provinceId | INT    | 否       | 省份ID   | 筛选                     |
| cityId     | INT    | 否       | 市ID     | 筛选                     |
| areaId     | INT    | 否       | 区域ID   | 筛选                     |
| townId     | INT    | 否       | 镇ID     | 筛选                     |
| villageId  | INT    | 否       | 乡ID     | 筛选                     |
| watersId   | INT    | 否       | 水域ID   | 筛选                     |
| sTime      | STRING | 否       | 开始时间 | 筛选                     |
| eTime      | STRING | 否       | 结束时间 | 筛选                     |
| projectIds | LIST   | 是       | 项目ID   | 登录成功以后返回的项目ID |

### 请求示例:

```bash
{
    "projectIds": [2]
}
```

### 响应

#### 200

```bash
{
    "data": {
        "count": 2,  // 总数
        "list": [
            {
                "id": 2,  // 探测任务ID
                "taskType": 2,  // 1:水下探测 2:河道测绘
                "areas": "200",  // 面积
                "distance": "200",  // 距离
                "name": "测绘任务001",  // 探测任务
                "cTime": "1632261669.000000",  // 任务创建时间
                "watersInfo": {  // 水域信息
                    "id": 4,
                    "name": "西湖"
                },
                "provinceInfo": {  // 省份信息
                    "id": 1,
                    "name": "浙江省"
                },
                "cityInfo": {  // 城市信息
                    "id": 1,
                    "name": "杭州市"
                },
                "areaInfo": {  // 区域信息
                    "id": 1,
                    "name": "萧山区"
                },
                "projectInfo": [ // 项目信息
                    {
                        "watersId": 4,  // 水域ID
                        "saleUser__mobile": "13069634826",  // 市场联系人
                        "saleUser__name": "吕品品123",  // 市场联系人姓名
                        "ownerUser__name": "吕品品123",  // 业主信息
                        "saleUser__duty": "职务-工程师123",  // 市场部门
                        "ownerUser__mobile": "13069634826",  // 业主联系人手机号
                        "shipId": 3,  // 船的ID
                        "amount": "66.55",  // 项目金额
                        "ownerUser__company": "BAT123", // 业主单位
                        "projectType": 1,  // 项目类型 1售前 2合同
                        "ship__number": "0018",  // 船的编号
                        "sTime": "2021-07-31T16:00:00Z", // 合同启动时间
                        "projectId": 4,  // 项目ID
                        "evaluation": 2, // 评价: 1非常好 2很好 3好 4一般
                        "eTime": "2021-08-05T16:00:00Z" // 合同结束时间
                    }
                ]
            },
            {
                "id": 1,
                "taskType": 1,
                "areas": "100",
                "distance": "100",
                "name": "探测任务001",
                "cTime": "1632261666.000000",
                "watersInfo": {
                    "id": 2,
                    "name": "西湖"
                },
                "provinceInfo": {
                    "id": 1,
                    "name": "浙江省"
                },
                "cityInfo": {
                    "id": 1,
                    "name": "杭州市"
                },
                "areaInfo": {
                    "id": 1,
                    "name": "萧山区"
                },
                "projectInfo": [
                    {
                        "watersId": 2,
                        "saleUser__mobile": "13069634826",
                        "saleUser__name": "吕品品123",
                        "ownerUser__name": "吕品品123",
                        "saleUser__duty": "职务-工程师123",
                        "ownerUser__mobile": "13069634826",
                        "shipId": 2,
                        "amount": "66.55",
                        "ownerUser__company": "BAT123",
                        "projectType": 1,
                        "ship__number": "0004",
                        "sTime": "2020-08-29T12:31:03Z",
                        "projectId": 3,
                        "evaluation": 1,
                        "eTime": "2020-08-29T12:31:14Z"
                    }
                ]
            }
        ],
        "links": {
            "previous": null,
            "next": null
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水下探测任务：

### 接口地址：/v1/pc/detect/task/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型 | 是否必传 | 命名   | 备注                     |
| ---------- | ---- | -------- | ------ | ------------------------ |
| projectIds | LIST | 是       | 项目ID | 登录成功以后返回的项目ID |

### 请求示例:

```bash
{
    "projectIds": [2]
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "distance": "200",  // 距离
            "task_type": 2, // 探测业务 1:水下探测 2:河道测绘
            "name": "测绘任务001", // 探测任务
            "c_time": "2021-09-21T22:01:09Z", // 日期
            "waters_id": 4,  // 水域ID
            "waters__name": "西湖",  // 水域名称
            "id": 2,  // 探测任务
            "areas": "200" // 面积
        },
        {
            "distance": "100",
            "task_type": 1,
            "name": "探测任务001",
            "c_time": "2021-09-21T22:01:06Z",
            "waters_id": 2,
            "waters__name": "西湖",
            "id": 1,
            "areas": "100"
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水下探测任务：

### 接口地址：/v1/pc/detect/task_detail/list/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名     | 备注                     |
| ---------- | ------ | -------- | -------- | ------------------------ |
| provinceId | INT    | 否       | 省份ID   | 筛选                     |
| cityId     | INT    | 否       | 市ID     | 筛选                     |
| areaId     | INT    | 否       | 区域ID   | 筛选                     |
| townId     | INT    | 否       | 镇ID     | 筛选                     |
| villageId  | INT    | 否       | 乡ID     | 筛选                     |
| watersId   | INT    | 否       | 水域ID   | 筛选                     |
| taskType   | INT    | 否       | 业务类型 | 筛选                     |
| sTime      | STRING | 否       | 开始时间 | 筛选                     |
| eTime      | STRING | 否       | 结束时间 | 筛选                     |
| projectIds | LIST   | 是       | 项目ID   | 登录成功以后返回的项目ID |

### 请求示例:

```bash
{
    "projectIds": [2]
}
```

### 响应

#### 200

```bash
{
    "data": {
        "count": 4, // 总数量
        "list": [
            {
                "id": 7,  // 任务详情ID
                "name": "河段002",  // 任务详情名称
                "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/cesao/ningbo_houtanghe_2021_0525_e2w_zip.mp4\n",  // 地址
                "detectType": 4,  // 见详情
                "deviceType": 1, // 见详情
                "distance": "100",  // 距离
                "sLng": "120.900683",  // 起点经度
                "sLat": "30.21611\n30.21611\n30.21611",  // 起点纬度
                "eLng": "120.900683",  // 终点经度
                "eLat": "30.21611\n30.21611\n30.21611",  // 终点纬度
                "sTime": "1632252700.000000",  // 开始时间
                "eTime": "1632252698.000000",  // 结束时间
                "provinceInfo": {  // 省份信息
                    "id": 1,
                    "name": "浙江省"
                },
                "cityInfo": {  // 城市信息
                    "id": 1,
                    "name": "杭州市"
                },
                "areaInfo": {  // 区域信息
                    "id": 1,
                    "name": "萧山区"
                },
                "watersInfo": {  // 水域信息
                    "id": 4,
                    "name": "西湖"
                },
                "shipInfo": {  // 船相关信息
                    "userName": "吕品品123",  // 运维人员
                    "userId": 1,  // 运维人员ID
                    "id": 3,  // 船的ID
                    "userMobile": "13069634826",  // 运维人员手机号
                    "number": "0018"  // 船的编号
                }
            }
        ], 
        "links": {
            "previous": null,
            "next": null
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水下探测成果：

### 接口地址：/v1/pc/detect/video/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型 | 是否必传 | 命名   | 备注                     |
| ---------- | ---- | -------- | ------ | ------------------------ |
| projectIds | LIST | 是       | 项目ID | 登录成功以后返回的项目ID |

### 请求示例:

```bash
{
    "projectIds": [2]
}
```

### 响应

#### 200

```bash
{
    "data": {
        "beam": [ // 多波束
            {
                "name": "河段002",  // 探测任务详情
                "detectTask__waters__name": "西湖", // 水域
                "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/cesao/ningbo_houtanghe_2021_0525_e2w_zip.mp4\n",  // 探测成果视频地址
                "deviceType": 1,  // 见详情
                "sTime": "2021-09-21T19:31:40Z",  // 探测时间
                "id": 7,
                "detectTask__watersId": 4 // 水域ID
            },
            {
                "name": "河段001",
                "detectTask__waters__name": "西湖",
                "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/cesao/ningbo_houtanghe_2021_0525_e2w_zip.mp4\n",
                "deviceType": 1,
                "sTime": "2021-09-21T19:30:27Z",
                "id": 6,
                "detectTask__watersId": 4
            }
        ],
        "sweep": [ // 侧扫
            {
                "name": "断面002",
                "detectTask__waters__name": "西湖",
                "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/cesao/ningbo_houtanghe_2021_0525_e2w_zip.mp4\n",
                "deviceType": 2,
                "sTime": "2021-09-21T19:29:16Z",
                "id": 3,
                "detectTask__watersId": 2
            },
            {
                "name": "断面001",
                "detectTask__waters__name": "西湖",
                "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/cesao/ningbo_houtanghe_2021_0525_e2w_zip.mp4\n",
                "deviceType": 2,
                "sTime": "2021-09-21T17:57:46Z",
                "id": 1,
                "detectTask__watersId": 2
            }
        ]
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水下探测成果-详情(测绘详情同一个接口)：

### 接口地址：/v1/pc/detect/video/detail/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名     | 备注                     |
| ---------- | ------ | -------- | -------- | ------------------------ |
| provinceId | INT    | 否       | 省份ID   | 筛选                     |
| cityId     | INT    | 否       | 市ID     | 筛选                     |
| areaId     | INT    | 否       | 区域ID   | 筛选                     |
| townId     | INT    | 否       | 镇ID     | 筛选                     |
| villageId  | INT    | 否       | 乡ID     | 筛选                     |
| watersId   | INT    | 否       | 水域ID   | 筛选                     |
| deviceType | INT    | 否       | 设备类型 | 探测成果筛选             |
| detectType | INT    | 否       | 探测分类 | 测绘详情筛选             |
| sTime      | STRING | 否       | 开始时间 | 筛选                     |
| eTime      | STRING | 否       | 结束时间 | 筛选                     |
| projectIds | LIST   | 是       | 项目ID   | 登录成功以后返回的项目ID |

### 请求示例:

```bash
{
    "projectIds": [2]
}
```

### 响应

#### 200

```bash
{
    "data": {
        "count": 4,
        "list": [
            {
                "id": 7, // 详情ID
                "name": "河段002",  // 详情名称
                "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/cesao/ningbo_houtanghe_2021_0525_e2w_zip.mp4\n", // 视频地址
                "detectType": 4, // 见详情
                "deviceType": 1, // 见详情
                "areas": "100", // 面积
                "distance": "100", // 距离
                "sLng": "120.900683",  // 起点经度
                "sLat": "30.21611\n30.21611\n30.21611", // 起点纬度
                "eLng": "120.900683", // 终点经度
                "eLat": "30.21611\n30.21611\n30.21611", // 终点纬度
                "sTime": "1632252700.000000", // 启动时间
                "eTime": "1632252698.000000", // 结束时间
                "provinceInfo": { // 省份
                    "id": 1,
                    "name": "浙江省"
                },
                "cityInfo": { // 城市
                    "id": 1,
                    "name": "杭州市"
                },
                "areaInfo": { // 区域
                    "id": 1,
                    "name": "萧山区"
                },
                "watersInfo": { // 水域
                    "id": 4,
                    "name": "西湖"
                },
                "shipInfo": { // 船相关
                    "userName": "吕品品123", // 运维人员
                    "userId": 1, // 运维ID
                    "id": 3,
                    "userMobile": "13069634826", // 运维联系
                    "number": "0018"
                },
                "detailResultInfo": [ // 水下异物
                    {
                        "name": "河道纵断面",
                        "cTime": "2021-09-21T19:41:04Z",
                        "taskDetailId": 7,
                        "bookMarkType": 3,
                        "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/3%E7%BA%B5%E5%89%96%E9%9D%A2.png",
                        "lat": "30.21611",
                        "lng": "120.900683\n120.900683",
                        "id": 6
                    },
                    {
                        "name": "河道横断面",
                        "cTime": "2021-09-21T19:40:17Z",
                        "taskDetailId": 7,
                        "bookMarkType": 2,
                        "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/2%E6%A8%AA%E6%96%AD%E9%9D%A2.png",
                        "lat": "30.21611",
                        "lng": "120.900683\n120.900683",
                        "id": 5
                    }
                ]
            }
        ],
        "links": {
            "previous": null,
            "next": null
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水下测绘成果：

### 接口地址：/v1/pc/detect/video/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型 | 是否必传 | 命名   | 备注                     |
| ---------- | ---- | -------- | ------ | ------------------------ |
| projectIds | LIST | 是       | 项目ID | 登录成功以后返回的项目ID |

### 请求示例:

```bash
{
    "projectIds": [2]
}
```

### 响应

#### 200

```bash
{
    "data": {
        "crossSection": [ // 横断面
            {
                "name": "河道横断面", // 成果名称
                "cTime": "2021-09-21T19:40:17Z",  // 创建时间
                "taskDetail__detectTask__name": "测绘任务001", // 任务详情
                "bookMarkType": 2,
                "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/2%E6%A8%AA%E6%96%AD%E9%9D%A2.png", // 图片
                "lat": "30.21611", // 纬度
                "taskDetail__detectTask__waters__name": "西湖", // 水域名称
                "lng": "120.900683\n120.900683", // 经度
                "id": 5
            }
        ],
        "longSection": [  // 纵断面
            {
                "name": "河道纵断面",
                "cTime": "2021-09-21T19:41:04Z",
                "taskDetail__detectTask__name": "测绘任务001",
                "bookMarkType": 3,
                "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/3%E7%BA%B5%E5%89%96%E9%9D%A2.png",
                "lat": "30.21611",
                "taskDetail__detectTask__waters__name": "西湖",
                "lng": "120.900683\n120.900683",
                "id": 6
            }
        ],
        "digitalRiver": [ // 河道数字
            {
                "name": "数字河道",
                "cTime": "2021-09-21T19:39:29Z",
                "taskDetail__detectTask__name": "测绘任务001",
                "bookMarkType": 1,
                "imageAddress": "https://qingdaofu-bucket.oss-cn-hangzhou.aliyuncs.com/1%E6%95%B0%E5%AD%97%E6%B2%B3%E9%81%93.png",
                "lat": "30.21611",
                "taskDetail__detectTask__waters__name": "西湖",
                "lng": "120.900683\n120.900683",
                "id": 4
            }
        ]
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

