# 智慧水域-大屏-水质模块

## 水质检测任务：

### 接口地址：v1/pc/water_quality/task/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型 | 是否必传 | 命名   | 备注 |
| ---------- | ---- | -------- | ------ | ---- |
| projectIds | LIST | 是       | 项目ID |      |

### 请求示例:

```bash
{
    "projectIds": [1,2,3,4],
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "wq_ts": "1655827200", // 日期时间戳(秒)
            "e_time": "2022-06-22T00:00:00Z", // 日期
            "water_quality__ship_id": 73, // 船ID
            "water_quality__area_id": 32,  // 水域区ID
            "water_quality__waters__name": "孝义河河口湿地",  // 水域名称
            "water_quality__quality": 2,  // 水质等级 2:II
            "water_quality__ship__number": "0028",  // 船的编号
            "water_quality__waters__e_lat": "38.7762603",  // 水域的纬度
            "water_quality__waters_id": 67,  // 水域ID
            "water_quality__area__name": "安新县",  // 水域区名称
            "water_quality__ship__name": "QDF-0028",  // 船的名称
            "water_quality__province__name": "河北省",  // 水域省份名称
            "water_quality__city_id": 28,  // 水域城市ID
            "water_quality__province_id": 14,  // 水域省份ID
            "water_quality__waters__e_lng": "115.8634185",  // 水域的纬度
            "id": 98,  // 水域河段ID
            "water_quality__city__name": "保定市"  // 水域城市名称
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水质检测任务详情-定点水质：

### 接口地址：v1/pc/water_quality/fixed/point/list/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名     | 备注 |
| ---------- | ------ | -------- | -------- | ---- |
| projectIds | LIST   | 是       | 项目ID   |      |
| shipName   | STRING | 否       | 船的名称 | 筛选 |
| provinceId | INT    | 否       | 省份     | 筛选 |
| watersId   | INT    | 否       | 水域     | 筛选 |
| sTime      | STRING | 否       | 开始日期 | 筛选 |
| eTime      | STRING | 否       | 结束日期 | 筛选 |

### 请求示例:

```bash
{
    "projectIds": [1,2,3,4],
}
```

### 响应

#### 200

```bash
{
    "data": {
        "count": 2,
        "list": [
            {
                "id": 10,  // 定点水位ID
                "lng": "120.900683",  // 经度
                "lat": "30.21611",  // 纬度
                "ph": "7.19", // 
                "nh3": "0.016075216972",
                "nh4": "1.40598196393",
                "k": "0.0945891783567",
                "cod": "4.96931863727",
                "turbidity": "23.7403306613",
                "dissOxy": "78.3954008016",
                "oxySaturation": "9.97",
                "cTime": "1631666676.000000",
                "wqTs": null,
                "shipInfo": { // 船的信息
                    "id": 2,
                    "name": "测试船",
                    "number": "00022"
                },
                "watersInfo": {  // 水域信息
                    "provinceName": "浙江省",
                    "provinceId": 1,
                    "watersName": "西湖",
                    "waterQualityId": 13,
                    "watersId": 30
                }
            }
        ],
        "links": {
            "previous": null,
            "next": null
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水质检测任务详情-动态水质：

### 接口地址：v1/pc/water_quality/dynamic/list/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名           | 备注 |
| ---------- | ------ | -------- | -------------- | ---- |
| projectIds | LIST   | 是       | 项目ID         |      |
| shipName   | STRING | 否       | 船的名称       | 筛选 |
| provinceId | INT    | 否       | 省份           | 筛选 |
| watersId   | INT    | 否       | 水域           | 筛选 |
| sTime      | FLOAT  | 否       | 开始日期时间戳 | 筛选 |
| eTime      | FLOAT  | 否       | 结束日期时间戳 | 筛选 |

### 请求示例:

```bash
{
    "projectIds": [1,2,3,4],
}
```

### 响应

#### 200

```bash
{
    "data": {
        "count": 78149,
        "list": [
            {
                "height": "3.88547730446",
                "s_time": 1637228043,
                "ship": {
                    "number": "0004",
                    "id": 17,
                    "name": "QDF-0004"
                },
                "c_data": {
                    "id": 20,
                    "name": "南京市"
                },
                "wgs84_lat": "32.0413168",
                "c_time": 1637228097286.0,
                "a_data": {
                    "id": 20,
                    "name": "建邺区"
                },
                "ph": "",
                "cod": "",
                "waters": {
                    "id": 14,
                    "name": "莫愁湖"
                },
                "nh4": "",
                "nh3": "",
                "oxy_saturation": "",
                "_id": "61961e41ad0529004908bc9e",
                "p_data": {
                    "id": 2,
                    "name": "江苏省"
                },
                "k": "",
                "diss_oxy": "",
                "_cls": "wisdom_waters_service.models.DynamicWaterQuality",
                "water_quality": null,
                "chlorophy": "",
                "turbidity": "",
                "wgs84_lng": "118.7582365"
            },
        ]
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 定点水质历史查询接口：

### 接口地址：v1/pc/history/fixed/point/day/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型   | 是否必传 | 命名     | 备注 |
| -------- | ------ | -------- | -------- | ---- |
| watersId | INT    | 是       | 水域ID   |      |
| pointId  | INT    | 是       | 点位ID   |      |
| sTime    | STRING | 是       | 开始日期 |      |
| eTime    | STRING | 是       | 结束日期 |      |

### 请求示例:

```bash
{
    "watersId": 22,
    "sTime": "2021-06-01",
    "eTime": "2021-06-17"
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
        		"water_quality_id": 25,  // 水质水域ID
        		"water_quality__name": "中唐河", // 水质名称
            "water_quality__number": "暗管-006",  // 水质的编号
            "c_time": "2021-06-16T00:00:52Z",  // 日期
            "k": "0",  // 钾离子
            "oxy_saturation": "3.07", // 溶解氧饱和度
            "diss_oxy": "40.4", // 溶解氧
            "nh4": "3.2", // nh4
            "cod": "23.9", // 化学需氧量
            "nh3": "0", // nh3
            "ph": "7.32",  // Ph
            "turbidity": "33.5", // 浊度
            "tp": "0.209", // 总磷
            "tn": "4.241", // 总氮
            "id": 24,
            "temp": null, // 温度
            "conduct": null, //电导率 
        },
        {		
		        "water_quality_id": 25,  // 水质水域ID
        		"water_quality__name": "中唐河", // 水质名称
            "water_quality__number": "暗管-006",  // 水质的编号
            "c_time": "2021-06-15T00:28:53Z",
            "k": "0.1",
            "oxy_saturation": "0.0",
            "diss_oxy": "0",
            "nh4": "1.4",
            "cod": "65.8",
            "nh3": "0",
            "ph": "7.04",
            "turbidity": "47.5",
            "tp": "0.209", // 总磷
            "tn": "4.241", // 总氮
            "id": 23
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 动态水质历史查询接口：

### 接口地址：v1/pc/history/dynamic/

### 请求方式：POST

### 请求参数：

| 参数名         | 类型   | 是否必传 | 命名               | 备注        |
| -------------- | ------ | -------- | ------------------ | ----------- |
| watersId       | INT    | 是       | 水域ID             |             |
| ts             | FLOAT  | 是       | 毫秒时间戳         | 当日凌晨0点 |
| category       | STRING | 是       | 获取需要的指标类型 | 默认是tp    |
| waterQualityId | INT    | 是       | 水域河段的ID       |             |

```bash
category: 详情：
ph ph值
nh3 nh3
nh4 nh4
k  钾离子
cod 化学需氧量
turbidity 浊度
diss_oxy 溶解氧
oxy_saturation 溶解氧饱和度
chlorophy 绿叶素
tn 总氮
tp 总磷
```

### 请求示例:

```bash
{
    "watersId": 2,
    "ts": 1635609600000,
    "category": "tp"
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "height": "4.66137361526",
            "s_time": 1635651790,
            "ship": {
                "number": "0004",
                "id": 2,
                "name": "西湖前进号"
            },
            "c_data": {
                "id": 1,
                "name": "杭州市"
            },
            "wgs84_lat": "32.0371814",
            "c_time": 1635651789578.0,
            "a_data": {
                "id": 1,
                "name": "萧山区"
            },
            "ph": "",
            "cod": "",
            "waters": {
                "id": 2,
                "name": "西湖"
            },
            "nh4": "",
            "nh3": "",
            "oxy_saturation": "",
            "_id": "617e10cdad0529004617726c",
            "p_data": {
                "id": 1,
                "name": "浙江省"
            },
            "k": "",
            "diss_oxy": "",
            "_cls": "wisdom_waters_service.models.DynamicWaterQuality",
            "water_quality": {
                "id": 5,
                "name": "断面003"
            },
            "chlorophy": "",
            "turbidity": "",
            "wgs84_lng": "118.752899"
        },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 动态水质历史查询接口-日筛选：

### 接口地址：v1/pc/history/dynamic/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型 | 是否必传 | 命名           | 备注        |
| -------- | ---- | -------- | -------------- | ----------- |
| watersId | INT  | 是       | 水域ID         |             |
| tsList   | LIST | 是       | 毫秒时间戳列表 | 当日凌晨0点 |

### 请求示例:

```bash
{
    "watersId": 2,
    "tsList": [1631721600000, 1635609600000]
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "result_list": [  // 水质相关信息
                {
                    "c_data": {
                        "id": 1,
                        "name": "杭州市"
                    },
                    "p_data": {
                        "id": 1,
                        "name": "浙江省"
                    },
                    "turbidity": "[u'turb']",
                    "water_quality": {
                        "id": 5,
                        "name": "断面003"
                    },
                    "wgs84_lat": "31.4001943",
                    "c_time": 1631750400000.0,
                    "chlorophy": "33",
                    "k": "23",
                    "_cls": "wisdom_waters_service.models.DynamicWaterQuality",
                    "oxy_saturation": "11",
                    "diss_oxy": "123",
                    "nh4": "12",
                    "a_data": {
                        "id": 1,
                        "name": "萧山区"
                    },
                    "cod": "123.12",
                    "nh3": "3",
                    "s_time": 1631893159,
                    "ph": "7.1",
                    "_id": "6144b6a7a541dda8ff126385",
                    "wgs84_lng": "120.866966",
                    "ship": {
                        "number": "0017",
                        "id": 2,
                        "name": "西湖前进号"
                    },
                    "waters": {
                        "id": 2,
                        "name": "西湖"
                    }
                }
            ],
            "ts": 1631721600000.0  // 日期时间戳 毫秒
        },
        {
            "result_list": [
                {
                    "height": "4.66137361526",
                    "s_time": 1635651790,
                    "ship": {
                        "number": "0004",
                        "id": 2,
                        "name": "西湖前进号"
                    },
                    "c_data": {
                        "id": 1,
                        "name": "杭州市"
                    },
                    "wgs84_lat": "32.0371814",
                    "c_time": 1635651789578.0,
                    "a_data": {
                        "id": 1,
                        "name": "萧山区"
                    },
                    "ph": "",
                    "cod": "",
                    "waters": {
                        "id": 2,
                        "name": "西湖"
                    },
                    "nh4": "",
                    "nh3": "",
                    "oxy_saturation": "",
                    "_id": "617e10cdad0529004617726c",
                    "p_data": {
                        "id": 1,
                        "name": "浙江省"
                    },
                    "k": "",
                    "diss_oxy": "",
                    "_cls": "wisdom_waters_service.models.DynamicWaterQuality",
                    "water_quality": {
                        "id": 5,
                        "name": "断面003"
                    },
                    "chlorophy": "",
                    "turbidity": "",
                    "wgs84_lng": "118.752899"
                }
            ],
            "ts": 1635609600000.0
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水质历史查询接口：

### 接口地址：v1/pc/history/water_quality/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型   | 是否必传 | 命名     | 备注 |
| -------- | ------ | -------- | -------- | ---- |
| watersId | INT    | 是       | 水域ID   |      |
| sTime    | STRING | 是       | 开始日期 |      |
| eTime    | STRING | 是       | 结束日期 |      |

### 请求示例:

```bash
{
    "watersId": 22,
    "sTime": "2021-06-01",
    "eTime": "2021-06-17"
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "c_time": "2021-06-16T00:00:52Z",  // 日期
            "k": "0",  // 钾离子
            "oxy_saturation": "3.07", // 溶解氧饱和度
            "diss_oxy": "40.4", // 溶解氧
            "nh4": "3.2", // nh4
            "cod": "23.9", // 化学需氧量
            "nh3": "0", // nh3
            "ph": "7.32",  // Ph
            "turbidity": "33.5", // 浊度
            "id": 24
        },
        {
            "c_time": "2021-06-15T00:28:53Z",
            "k": "0.1",
            "oxy_saturation": "0.0",
            "diss_oxy": "0",
            "nh4": "1.4",
            "cod": "65.8",
            "nh3": "0",
            "ph": "7.04",
            "turbidity": "47.5",
            "id": 23
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水质多日数据对比接口(新)：

### 接口地址：v1/pc/history/filter/day/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型   | 是否必传 | 命名     | 备注     |
| -------- | ------ | -------- | -------- | -------- |
| watersId | INT    | 是       | 水域ID   |          |
| tsList   | LIST   | 是       | 日期筛选 |          |
| category | STRING | 是       | 类型     | 默认是tp |

### 请求示例:

```bash
{
    "tsDate": 1636646400000,
    "shipNum": "0004",
    "watersId": 14
}
```

```bash
category: 详情：
ph ph值
nh3 nh3
nh4 nh4
k  钾离子
cod 化学需氧量
turbidity 浊度
diss_oxy 溶解氧
oxy_saturation 溶解氧饱和度
chlorophy 绿叶素
tn 总氮
tp 总磷
conduct 电导率
temp 温度
```

### 响应

#### 200

```bash
{
    "data": [
    {
      "turbidity": "41.7",
      "chlorophy": "",
      "k": "0.0",
      "oxy_saturation": "6.16",
      "diss_oxy": "77.3",
      "nh4": "3.9",
      "cod": "58.1",
      "nh3": "0.0",
      "conduct": null,
      "temp": null,
      "s_time": 1622615227,
      "ph": "7.57",
      "_id": "61cdda8cdffa7185502abe5f"
      "ship": {
                  "number": "0004",
                  "id": 17,
                  "name": "QDF-0004"
              },
     "waters": {
     				"id": 14,
              "name": "莫愁湖"
     	},
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水质总览-详情列表接口：

### 接口地址：v1/pc/water_quality/overview/list/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名     | 备注 |
| ---------- | ------ | -------- | -------- | ---- |
| provinceId | INT    | 否       | 省份ID   | 筛选 |
| cityId     | INT    | 否       | 市ID     | 筛选 |
| areaId     | INT    | 否       | 区域ID   | 筛选 |
| townId     | INT    | 否       | 镇ID     | 筛选 |
| villageId  | INT    | 否       | 乡ID     | 筛选 |
| watersId   | INT    | 否       | 水域ID   | 筛选 |
| sTime      | STRING | 否       | 开始时间 | 筛选 |
| eTime      | STRING | 否       | 结束时间 | 筛选 |
| projectIds | LIST   | 是       | 项目ID   |      |

### 请求示例:

* 

### 响应

#### 200

```bash
{
    "data": {
        "count": 17,
        "list": [
            {
                "id": 49,  // 项目ID
                "amount": null,  // 金额
                "num": "HMH-001",  // 项目编号
                "name": "昆明湖项目",  // 项目名称 
                "businessType": 6,  // 业务类型 见详情
                "projectType": 1,  // 项目类型
                "areas": "",  // 面积
                "distance": "",  // 地区
                "evaluation": null,  // 评价
                "provinceInfo": {},  // 省份信息
                "cityInfo": {},  // 城市信息
                "areaInfo": {},  // 区域信息
                "townInfo": {},
                "villageInfo": {},
                "areaType": null,  // 区域
                "watersInfo": {  // 水域信息
                    "id": 33,
                    "name": "昆明湖",
                    "quality": 1, // 水质等级  1:I ~ 6:VI 总共就6个等级
                },
                "sTime": "1635609600.000000",  // 开始时间
                "eTime": "1635609600.000000",  // 结束时间
                "saleAmount": null,  // 销售金额 
                "projectShip": [  // 几艘船
                    {
                        "shipId": 20,  // 船的ID
                        "shipType": 1,  // 船的类型 1:无人船  2:冲锋舟
                        "id": 19,  
                        "shipNumber": "0007",  // 船的编号
                        "shipName": "QDF-0007"  // 船的名称
                    }
                ],
                "salesType": null,  // 销售类型
                "oUser": "",  // 业主
                "oCompany": "",  // 业主单位
                "oMobile": "",  // 业主手机号
                "sUser": "",  // 销售姓名
                "sMobile": "",  // 销售手机号
                "sCompany": ""  // 销售公司
            },
        ],
        "links": {
            "previous": null,
            "next": "http://127.0.0.1:8000/v1/pc/business/overall/list/?page=2"
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水质检测模块(新接口)：

### 接口地址：v1/pc/new/water_quality/task/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型 | 是否必传 | 命名   | 备注 |
| ---------- | ---- | -------- | ------ | ---- |
| projectIds | LIST | 是       | 项目ID |      |

### 请求示例:

* 

### 响应

#### 200

```bash
{
    "data": {
        "count": 36,
        "list": [
            {
                "id": 61, // 水质表ID
                "quality": 2, // 水质等级
                "address": "",  // 地址
                "sLng": "12.21321312",  // 经度
                "sLat": "12.21321312", // 纬度
                "name": "后塘河",  // 检测任务名称
                "number": "0001", // 编号
                "mUser": "",
                "mMobile": "",
                "eLat": "12.21321312",
                "provinceInfo": { // 省份信息
                    "id": 1,
                    "name": "浙江省"
                },
                "cityInfo": {  // 城市信息
                    "id": 18,
                    "name": "宁波市"
                },
                "areaInfo": {  // 区域信息
                    "id": 19,
                    "name": "鄞州区"
                },
                "shipInfo": { // 船舶信息
                    "id": 17,
                    "name": "QDF-0004",
                    "number": "0004"
                },
                "watersInfo": {  // 水域信息
                    "id": 22,
                    "name": "后塘河"
                },
                "cTime": "1624291200.000000", // 创建日期
                "eLng": "12.21321312",
                "qualityCount": 443 // 检测点位
            }
        ],
        "links": {
            "previous": null,
            "next": "http://127.0.0.1:8000/v1/pc/new/water_quality/task/?page=2"
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取当前项目下负责哪些水域信息：

### 接口地址：v1/pc/get/project_waters/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型 | 是否必传 | 命名   | 备注 |
| ---------- | ---- | -------- | ------ | ---- |
| projectIds | LIST | 是       | 项目ID |      |

### 请求示例:

```bash
{"projectIds": [1,2,5,8]}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "number": "ZJ-RA-TTPH",  // 水域编号
            "id": 71, // 水域ID
            "name": "汀田浦河"  // 水域名称
        },
        {
            "number": "ZJ-ZS-LTZH",
            "id": 70,
            "name": "田螺峙河"
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取定点水质的点位信息：

### 接口地址：v1/pc/get/waters_point/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型 | 是否必传 | 命名   | 备注 |
| -------- | ---- | -------- | ------ | ---- |
| watersId | INT  | 是       | 水域ID |      |

### 请求示例:

```bash
{"watersId": 69}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "number": "03_135922",  // 定点点位编号
            "id": 78,  // 定点点位ID
            "name": "疑似暗管09" // 定点点位名称
        },
        {
            "number": "13_134340",
            "id": 79,
            "name": "疑似暗管06"
        },
        {
            "number": "09_142743",
            "id": 80,
            "name": "疑似暗管01"
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取水域-河段信息：

### 接口地址：v1/pc/get/waters_river/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型 | 是否必传 | 命名   | 备注 |
| -------- | ---- | -------- | ------ | ---- |
| watersId | INT  | 是       | 水域ID |      |

### 请求示例:

```bash
{"watersId": 69}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "number": "",  // 河段编号
            "id": 68,  // 河段ID
            "name": "白泉主河"  // 河段名称
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 新建-水域标注区域接口：

### 接口地址：v1/pc/water_area_mark/

### 请求方式：POST

### 请求参数：

| 参数名   | 类型   | 是否必传 | 命名         | 备注                     |
| -------- | ------ | -------- | ------------ | ------------------------ |
| watersId | INT    | 是       | 水域ID       |                          |
| areas    | STRING | 是       | 区域点       | 规则是: 经度,纬度-       |
| markType | INT    | 是       | 区域标记类型 | 1:多边形、2:矩形、3:圆形 |

> 注意：areas 参数, 里面是字符串, 规则是经度,纬度 然后 - 进行连接, 经度,纬度。
>
>  如果是圆形那么就是 经度,纬度-半径, markType=3

### 请求示例:

```bash
{
    "watersId": 77,
    "areas": "120.646781921,31.2699222565-120.646781921,31.2699222565-120.646781921,31.2699222565-120.646781921,31.2699222565-120.646781921,31.2699222565-120.646781921,31.2699222565",
    "markType": 1
}
```

### 响应

#### 200

```bash
{
    "data": {
        "id": 2  // 新增水域区域标注ID
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 编辑-水域标注区域接口：

### 接口地址：v1/pc/water_area_mark/

### 请求方式：PUT

### 请求参数：

| 参数名   | 类型   | 是否必传 | 命名           | 备注                     |
| -------- | ------ | -------- | -------------- | ------------------------ |
| markId   | INT    | 是       | 水域标注区域ID |                          |
| areas    | STRING | 是       | 区域点         | 规则是: 经度,纬度-       |
| markType | INT    | 是       | 区域标记类型   | 1:多边形、2:矩形、3:圆形 |

> 注意：areas 参数, 里面是字符串, 规则是经度,纬度 然后 - 进行连接, 经度,纬度。
>
>  如果是圆形那么就是 经度,纬度-半径, markType=3

### 请求示例:

```bash
{
    "markId": 2,
    "areas": "120.646781921,31.2699222565-120.646781921,31.2699222565-120.646781921,31.2699222565",
    "markType": 2
}
```

### 响应

#### 200

```bash
{
    "data": {
        "id": 2  // 修改水域区域标注ID
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 删除-水域标注区域接口：

### 接口地址：v1/pc/water_area_mark/

### 请求方式：DELETE

### 请求参数：

| 参数名 | 类型 | 是否必传 | 命名           | 备注 |
| ------ | ---- | -------- | -------------- | ---- |
| markId | INT  | 是       | 水域标注区域ID |      |

### 请求示例:

```bash
?markId=2
```

### 响应

#### 200

```bash
{
    "data": {
        "id": 2  // 删除的水域区域标注ID
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 保存-水域标注区域接口(新增/编辑/删除)：

### 接口地址：v1/pc/save/water_area_mark/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型 | 是否必传 | 命名           | 备注 |
| ---------- | ---- | -------- | -------------- | ---- |
| watersId   | INT  | 是       | 水域ID         |      |
| createList | LIST | 否       | 新增数据的列表 |      |
| updateList | LIST | 否       | 更新数据列表   |      |
| deleteList | LIST | 否       | 删除数据列表   |      |

### 请求示例:

```bash
{
    "watersId":72,  // 水域ID
    "create":[  // 所有创建的操作
        {
            "markType":1,  // 类型
            "areas":[ // 区域
                {
                    "lng":"经度",
                    "lat":"纬度"
                },
                {
                    "lng":"经度",
                    "lat":"纬度"
                }
            ]
        },
        {
            "markType":3,  // 类型: 圆形
            "areas":[ // 区域
                {
                    "lng":"经度",
                    "lat":"纬度",
                    "radius": 0.5 // 半径
                },
            ]
        }
    ],
    "update":[ // 所有更新的操作
        {
            "id":1, // 标注数据的ID
            "markType":1,
            "areas":[
                {
                    "lng":"经度",
                    "lat":"纬度"
                }
            ]
        }
    ],
    "delete":[ // 所有删除的操作, 里面是删除的ID
        2,
        3,
        4
    ]
}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取水域标注区域列表页接口(APP/大屏幕/驾驶舱共用一套接口)：

### 接口地址：v1/pc/water_area_mark/list/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名                                   | 备注 |
| ---------- | ------ | -------- | -------------------------------------- | ---- |
| watersIds  | LIST   | 是       | 登录成功以后获取到的账号对应的水域信息 |      |
| watersName | STRING | 否       | 按照水域名称进行筛选                   |      |
| cityName   | STRING | 否       | 按照地名进行筛选                       |      |

### 请求示例:

```bash
{
    "watersIds": [
        78
    ],
    "watersName": "环城"
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "waters_id": 78,  // 水域ID
            "mark_type": 3, // 水域区域标注类型 1:多边形、2:矩形、3:圆形
            "waters__name": "环城河", // 水域名称
            "id": 2, // 水域标注主键ID
            "area": [ // 区域信息
                {
                    "lat": "333.12", // 经度
                    "lng": "33.12", // 纬度
                    "radius": 0.5 // 半径
                }
            ], 
            "waters__e_lat": "30.9072979", // 水域纬度
            "waters__e_lng": "120.9416445"// 水域经度

        },
        {
            "waters_id": 78,
            "mark_type": 1,
            "waters__name": "环城河",
            "id": 1,
            "area": [ // 区域信息
                {
                    "lat": "333.12", // 经度
                    "lng": "33.12", // 纬度
                    "radius": 0.5 // 半径
                }
            ], 
            "waters__e_lat": "", 
            "waters__e_lng": ""
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 新建-水域标签区域接口：

### 接口地址：v1/pc/water_area_label/

### 请求方式：POST

### 请求参数：

| 参数名    | 类型   | 是否必传 | 命名         | 备注                        |
| --------- | ------ | -------- | ------------ | --------------------------- |
| labelList | LIST   | 是       | 数据列表     |                             |
| watersId  | INT    | 是       | 水域ID       |                             |
| areas     | STRING | 是       | 区域点       | 规则是: 经度,纬度           |
| name      | STRING | 是       | 标签名称     |                             |
| desc      | STRING | 是       | 标签描述信息 |                             |
| sTime     | STRING | 是       | 上传日期     | YYYY-MM-DD                  |
| imageList | LIST   | 否       | 附件         | 可上传/视频、图片(外链地址) |

> 注意：areas 参数, 里面是字符串, 规则是经度,纬度, 返回给前端,需要自行处理, 按照逗号进行切割

### 请求示例:

```bash
{
    "labelList": [
        {
            "watersId": 78,
            "areas": "120.9416445,30.9072979",
            "name": "1自定义标签",
            "desc": "1自定义标签描述信息",
            "sTime": "2022-10-03",
            "imageList": [
                "xxxx.com",
                "xxxxx.com",
                "xxxxxxx.com"
            ]
        },
        {
            "watersId": 78,
            "areas": "120.9416445,30.9072979",
            "name": "2自定义标签",
            "desc": "2自定义标签描述信息",
            "sTime": "2022-10-03",
            "imageList": [
                "xxxx.com",
                "xxxxx.com",
                "xxxxxxx.com"
            ]
        }
    ]
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "id": 90  // 创建成功的ID
        },
        {
            "id": 91
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 编辑-水域标签区域接口：

### 接口地址：v1/pc/water_area_label/update/

### 请求方式：POST

### 请求参数：

| 参数名    | 类型   | 是否必传 | 命名         | 备注                        |
| --------- | ------ | -------- | ------------ | --------------------------- |
| labelList | LIST   | 是       | 数据列表     |                             |
| labelId   | INT    | 是       | 水域标签ID   |                             |
| areas     | STRING | 是       | 区域点       | 规则是: 经度,纬度           |
| name      | STRING | 是       | 标签名称     |                             |
| desc      | STRING | 是       | 标签描述信息 |                             |
| sTime     | STRING | 是       | 上传日期     | YYYY-MM-DD                  |
| imageList | LIST   | 否       | 附件         | 可上传/视频、图片(外链地址) |

> 注意：areas 参数, 里面是字符串, 规则是经度,纬度, 返回给前端,需要自行处理, 按照逗号进行切割

### 请求示例:

```bash
{
    "labelList": [
        {
            "labelId": 90,
            "areas": "120.9416445,30.9072979",
            "name": "修改自定义标签666",
            "desc": "修改自定义标签描述信息666",
            "sTime": "2022-10-03",
            "imageList": [
                "11www.xxxx.com",
                "11www.xxxxx.com",
                "11www.xxxxxxx.com"
            ]
        },
        {
            "labelId": 91,
            "areas": "120.9416445,30.9072979",
            "name": "修改自定义标签888",
            "desc": "修改自定义标签描述信息888",
            "sTime": "2022-10-03",
            "imageList": [
                "22www.xxxx.com",
                "22www.xxxxx.com",
                "22www.xxxxxxx.com"
            ]
        }
    ]
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "id": 90 // 标签ID
        },
        {
            "id": 91
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取详情-水域标签区域接口：

### 接口地址：v1/pc/water_area_label/

### 请求方式：GET

### 请求参数：

| 参数名  | 类型 | 是否必传 | 命名       | 备注 |
| ------- | ---- | -------- | ---------- | ---- |
| labelId | INT  | 是       | 水域标签ID |      |

### 请求示例:

```bash
?labelId=4
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "waters_id": 78, // 水域ID
            "s_ts": null, // 创建时间戳
            "area": "120.9416445,30.9072979", // 经度,纬度
            "waters__name": "环城河", // 水域名称
            "name": "修改自定义标签", // 标签名称
            "s_time": "2022-10-02T00:00:00Z",  // 创建时间对象
            "att_list": [ // 上传附件
                {
                    "id": 4,
                    "image_address": "www.xxxx.com"
                },
                {
                    "id": 5,
                    "image_address": "www.xxxxx.com"
                },
                {
                    "id": 6,
                    "image_address": "www.xxxxxxx.com"
                }
            ],
            "id": 4, // 水域标签ID
            "desc": "修改自定义标签描述信息" // 水域标签描述
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 删除-水域标签区域接口(此接口去掉)：

### 接口地址：v1/pc/water_area_label/

### 请求方式：DELETE

### 请求参数：

| 参数名  | 类型 | 是否必传 | 命名       | 备注 |
| ------- | ---- | -------- | ---------- | ---- |
| labelId | INT  | 是       | 水域标签ID |      |

### 请求示例:

```bash
?labelId=4
```

### 响应

#### 200

```bash
{
    "data": {
        "id": 4
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 批量删除-水域标签区域接口：

### 接口地址：v1/pc/water_area_label/delete/

### 请求方式：POST

### 请求参数：

| 参数名    | 类型 | 是否必传 | 命名           | 备注 |
| --------- | ---- | -------- | -------------- | ---- |
| labelList | LIST | 是       | 水域标签ID列表 |      |

### 请求示例:

```bash
{"labelList": [90, 91]}
```

### 响应

#### 200

```bash
{
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 获取水域标签区域列表页接口(APP/大屏幕/驾驶舱共用一套接口)：

### 接口地址：v1/pc/water_area_label/list/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名                                   | 备注 |
| ---------- | ------ | -------- | -------------------------------------- | ---- |
| watersIds  | LIST   | 是       | 登录成功以后获取到的账号对应的水域信息 |      |
| watersName | STRING | 否       | 按照水域名称进行筛选                   |      |
| cityName   | STRING | 否       | 按照地名进行筛选                       |      |

### 请求示例:

```bash
{
    "watersIds": [
        78
    ],
    "watersName": "环城"
}
```

### 响应

#### 200

```bash
{
    "data": [
        {
            "s_ts": "1664811243", // 上传时间戳
            "waters_id": 78, // 水域ID
            "area": "120.9416445,30.9072979", // 经度,纬度
            "waters__e_lng": "", // 水域的经度
            "s_time": "2022-10-03T00:00:00Z", // 上传时时间对象
            "name": "自定义标签", // 标签名称
            "waters__e_lat": "", // 水域的纬度
            "waters__name": "环城河", // 水域的名称
            "att_list": [ // 水域标签的附件(照片/视频)
                {
                    "id": 7,
                    "image_address": "xxxx.com" // 外链地址
                },
                {
                    "id": 8,
                    "image_address": "xxxxx.com"
                },
                {
                    "id": 9,
                    "image_address": "xxxxxxx.com"
                }
            ],
            "id": 5, // 水域标签ID
            "desc": "自定义标签描述信息" // 水域标签描述信息
        }
    ],
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

## 水质预警列表接口：

### 接口地址：v1/pc/water_quality/warning/

### 请求方式：POST

### 请求参数：

| 参数名     | 类型   | 是否必传 | 命名                                   | 备注 |
| ---------- | ------ | -------- | -------------------------------------- | ---- |
| watersIds  | LIST   | 是       | 登录成功以后获取到的账号对应的水域信息 |      |
| provinceId | INT    | 否       | 省份ID                                 | 筛选 |
| cityId     | INT    | 否       | 城市ID                                 | 筛选 |
| areaId     | INT    | 否       | 区域ID                                 | 筛选 |
| sTime      | STRING | 否       | 开始时间                               | 筛选 |
| eTime      | STRING | 否       | 结束时间                               | 筛选 |

### 请求示例:

```bash
{
    "watersIds": [
        67
    ]
}
```

### 响应

#### 200

```bash
{
    "data": {
        "count": 3, // 总数
        "list": [
            {
                "id": 5, // 预警ID
                "type": 1, // 类型: 1:监测点、2:监测河段
                "alarmType": 3,  // 预警类型: 1:岸边排污、2:水下排污、3:水质异常
                "lng": "120.592689514", // 经度
                "lat": "27.7463989258", // 纬度
                "ph": "7.6",  // ph
                "nh3": "12", // nh3
                "nh4": null, //nh4
                "k": null, // k 
                "tp": null,  // 总磷
                "tn": null,  // 总氮
                "cod": "12",  // 化学需氧量
                "turbidity": "332",  // 浊度
                "dissOxy": "32.1",  // 溶解氧
                "oxySaturation": "1",  // 溶解氧饱和度
                "chlorophy": "123", // 叶绿素
                "conduct": "122",  // 电阻率
                "temp": null,  // 温度
                "sod": null, // 透明度
                "codMn": "1",  // 高锰酸钾
                "tsm": "5",  // 悬浮物
                "sTime": "2022-10-29T00:00:00+08:00",  // 当天日期
                "eTime": "1667001600.000000", // 当天日期时间戳
                "cTime": "1667047045.280206", // 创建时间戳-毫秒
                "wqTs": "1667047004",  // 创建时间戳-秒
                "watersInfo": { // 水域信息
                    "lat": "38.7762603",  
                    "lng": "115.8634185",
                    "id": 67,
                    "name": "孝义河河口湿地"
                },
                "shipInfo": { // 船舶信息
                    "number": "0099",
                    "id": 68,
                    "name": "QDF-0099"
                },
                "wqDetectInfo": { // 水质检测信息
                    "id": 85,
                    "name": "孝义河"
                },
                "provinceInfo": { // 省份
                    "id": 14,
                    "name": "河北省"
                },
                "cityInfo": { // 城市
                    "id": 28,
                    "name": "保定市"
                },
                "areaInfo": { 区域
                    "id": 32,
                    "name": "安新县"
                }
            },
        ],
        "links": {
            "previous": null,
            "next": null
        }
    },
    "retCode": 0,
    "retMsg": "成功 | Success"
}
```

